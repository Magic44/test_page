<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>(一) 建表规约</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part21.htm">&lt; 上一个</a><span> | </span><a href="../阿里云嵩山版Java开发手册.html">内容</a><span> | </span><a href="part23.htm">下一个 &gt;</a></p><p class="s16" style="padding-top: 12pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark39">(一) 建表规约</a><a name="bookmark44">&zwnj;</a></p><p class="s9" style="padding-top: 4pt;padding-left: 24pt;text-indent: 0pt;line-height: 22pt;text-align: justify;">1. <span style=" color: #C00000;">【强制】</span><span style=" color: #23292D;">表达是与否概念的字段，必须使用 </span>is_xxx <span style=" color: #23292D;">的方式命名，数据类型是 </span>unsigned tinyint</p><p class="s25" style="padding-left: 42pt;text-indent: 0pt;line-height: 22pt;text-align: justify;">（1 表示是，0 表示否）。</p><p class="s26" style="padding-left: 42pt;text-indent: 0pt;text-align: justify;"><span style=" color: #967B00;">说明：</span>任何字段如果为非负数，必须是 <span style=" color: #333;">unsigned</span>。</p><p style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;line-height: 109%;text-align: justify;"><span style=" color: #967B00;">注意：</span>POJO <span style=" color: #23292D;">类中的任何布尔类型的变量，都不要加 </span>is <span style=" color: #23292D;">前缀，所以，需要在&lt;</span>resultMap<span style=" color: #23292D;">&gt;设置从 </span>is_xxx <span style=" color: #23292D;">到 </span>Xxx <span style=" color: #23292D;">的映射关系。数据库表示是与否的值，使用 </span>tinyint <span style=" color: #23292D;">类型，坚持 </span>is_xxx <span style=" color: #23292D;">的命名方式是为了明确其取值含义与取值范围。</span></p><p class="s26" style="padding-left: 42pt;text-indent: 0pt;text-align: justify;"><span style=" color: #009757;">正例：</span>表达逻辑删除的字段名 <span style=" color: #333;">is_deleted</span>，1 表示删除，0 表示未删除。</p><p class="s9" style="padding-top: 10pt;padding-left: 42pt;text-indent: -18pt;text-align: left;">2. <span style=" color: #C00000;">【强制】</span>表名、字段名必须使用小写字母或数字<span class="s12">，</span>禁止出现数字开头，禁止两个下划线中间只出现数字。数据库字段名的修改代价很大，因为无法进行预发布，所以字段名称需要慎重考虑。<span class="s21">说明：</span><span class="s12">MySQL 在 Windows 下不区分大小写，但在 Linux 下默认是区分大小写。因此，数据库名、表名、字段名，都不允许出现任何大写字母，避免节外生枝。</span></p><p style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;line-height: 110%;text-align: left;"><span style=" color: #009757;">正例：</span>aliyun_admin，rdc_config，level3_name<span style=" color: #FF4500;">反例：</span>AliyunAdmin，rdcConfig，level_3_name</p><p class="s9" style="padding-top: 5pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">3. <span style=" color: #C00000;">【强制】</span>表名不使用复数名词。</p><p class="s27" style="padding-left: 42pt;text-indent: 0pt;line-height: 110%;text-align: left;">说明：<span style=" color: #333;">表名应该仅仅表示表里面的实体内容，不应该表示实体数量，对应于 DO 类名也是单数形式，符合表达习惯。</span></p><p class="s9" style="padding-top: 5pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">4. <span style=" color: #C00000;">【强制】</span>禁用保留字，如 desc、range、match、delayed 等，请参考 MySQL 官方保留字。</p><p class="s9" style="padding-top: 6pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">5. <span style=" color: #C00000;">【强制】</span>主键索引名为 <span class="s12">pk_</span>字段名；唯一索引名为 <span class="s12">uk</span>_字段名<span class="s12">；</span>普通索引名则为 <span class="s12">idx</span>_字段名。</p><p class="s27" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">说明：<span style=" color: #333;">pk_ 即 primary key；uk_ 即 unique key；idx_ 即 index 的简称。</span></p><p class="s9" style="padding-top: 7pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">6. <span style=" color: #C00000;">【强制】</span>小数类型为 decimal，禁止使用 float 和 double。</p><p class="s27" style="padding-left: 42pt;text-indent: 0pt;line-height: 109%;text-align: left;">说明：<span style=" color: #333;">在存储的时候，float 和 double 都存在精度损失的问题，很可能在比较值的时候，得到不正确的结果。如果存储的数据范围超过 decimal 的范围，建议将数据拆成整数和小数并分开存储。</span></p><p class="s9" style="padding-top: 6pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">7. <span style=" color: #C00000;">【强制】</span>如果存储的字符串长度几乎相等，使用 <span class="s12">char </span>定长字符串类型。</p><p class="s9" style="padding-top: 7pt;padding-left: 42pt;text-indent: -18pt;text-align: justify;">8. <span style=" color: #C00000;">【强制】</span><span class="s12">varchar </span>是可变长字符串，不预先分配存储空间，长度不要超过 5000，如果存储长度大于此值，定义字段类型为 <span class="s12">text</span>，独立出来一张表，用主键来对应，避免影响其它字段索引效率。</p><p class="s9" style="padding-top: 6pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">9. <span style=" color: #C00000;">【强制】</span>表必备三字段：id, create_time, update_time。</p><p class="s27" style="padding-left: 42pt;text-indent: 0pt;text-align: justify;">说明：<span style=" color: #333;">其中 id 必为主键，类型为bigint unsigned、单表时自增、步长为 1。create_time, update_time</span></p><p style="padding-top: 1pt;padding-left: 42pt;text-indent: 0pt;text-align: justify;">的类型均为 datetime 类型，前者现在时表示主动式创建，后者过去分词表示被动式更新。</p><p class="s9" style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">10. <span style=" color: #FFC000;">【推荐】</span>表的命名最好是遵循“业务名称_表的作用”。</p><p class="s24" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">正例：<span style=" color: #333;">alipay_task / force_project / trade_config</span></p><p class="s9" style="padding-top: 7pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">11. <span style=" color: #FFC000;">【推荐】</span>库名与应用名称尽量一致。</p><p class="s9" style="padding-top: 6pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">12. <span style=" color: #FFC000;">【推荐】</span>如果修改字段含义或对字段表示的状态追加时，需要及时更新字段注释。</p><p class="s9" style="padding-top: 6pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">13. <span style=" color: #FFC000;">【推荐】</span>字段允许适当冗余，以提高查询性能，但必须考虑数据一致。冗余字段应遵循：</p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">1） 不是频繁修改的字段。</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">2） 不是唯一索引的字段。</p><p style="padding-top: 1pt;padding-left: 45pt;text-indent: 0pt;text-align: left;">3） 不是 varchar 超长字段，更不能是text 字段。</p><p class="s24" style="padding-top: 1pt;padding-left: 43pt;text-indent: 0pt;text-align: left;">正例：<span style=" color: #333;">各业务线经常冗余存储商品名称，避免查询时需要调用 IC 服务获取。</span></p><p class="s9" style="padding-top: 7pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">14. <span style=" color: #FFC000;">【推荐】</span>单表行数超过 500 万行或者单表容量超过 2GB，才推荐进行分库分表。</p><p class="s27" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">说明：<span style=" color: #333;">如果预计三年后的数据量根本达不到这个级别，请不要在创建表时就分库分表。</span></p><p class="s9" style="padding-top: 8pt;padding-left: 42pt;text-indent: -18pt;text-align: left;">15. <span style=" color: #76923B;">【参考】</span>合适的字符存储长度，不但节约数据库表空间、节约索引存储，更重要的是提升检索速度。</p><p class="s24" style="padding-left: 42pt;text-indent: 0pt;text-align: left;">正例：<span style=" color: #333;">无符号值可以避免误存负数，且扩大了表示范围。</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:60.925pt" cellspacing="0"><tr style="height:31pt"><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD" bgcolor="#E4E4E4"><p class="s77" style="padding-top: 5pt;padding-left: 21pt;text-indent: 0pt;text-align: left;">对象</p></td><td style="width:78pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD" bgcolor="#E4E4E4"><p class="s77" style="padding-top: 5pt;padding-left: 18pt;text-indent: 0pt;text-align: left;">年龄区间</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD" bgcolor="#E4E4E4"><p class="s77" style="padding-top: 5pt;padding-left: 38pt;padding-right: 37pt;text-indent: 0pt;text-align: center;">类型</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD" bgcolor="#E4E4E4"><p class="s77" style="padding-top: 5pt;padding-left: 17pt;padding-right: 16pt;text-indent: 0pt;text-align: center;">字节</p></td><td style="width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD" bgcolor="#E4E4E4"><p class="s77" style="padding-top: 5pt;padding-left: 54pt;padding-right: 53pt;text-indent: 0pt;text-align: center;">表示范围</p></td></tr><tr style="height:31pt"><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">人</p></td><td style="width:78pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">150 岁之内</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">tinyint unsigned</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;text-indent: 0pt;text-align: center;">1</p></td><td style="width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">无符号值：0 到 255</p></td></tr><tr style="height:30pt"><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">龟</p></td><td style="width:78pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">数百岁</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">smallint unsigned</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;text-indent: 0pt;text-align: center;">2</p></td><td style="width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">无符号值：0 到 65535</p></td></tr><tr style="height:31pt"><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">恐龙化石</p></td><td style="width:78pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">数千万年</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">int unsigned</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;text-indent: 0pt;text-align: center;">4</p></td><td style="width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">无符号值：0 到约 43 亿</p></td></tr><tr style="height:30pt"><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">太阳</p></td><td style="width:78pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">约 50 亿年</p></td><td style="width:99pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">bigint unsigned</p></td><td style="width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;text-indent: 0pt;text-align: center;">8</p></td><td style="width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#DDDDDD;border-left-style:solid;border-left-width:1pt;border-left-color:#DDDDDD;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#DDDDDD;border-right-style:solid;border-right-width:1pt;border-right-color:#DDDDDD"><p class="s13" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">无符号值：0 到约 10 的 19 次方</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part21.htm">&lt; 上一个</a><span> | </span><a href="../阿里云嵩山版Java开发手册.html">内容</a><span> | </span><a href="part23.htm">下一个 &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
